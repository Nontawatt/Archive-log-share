# ===== SIEM → Google Drive Archiver Config =====

# ค่าที่ใช้แทนในคำสั่ง (ถ้าจำเป็น)
SIEM_USERNAME="siem_user"
SIEM_PASSWORD="siem_password"
SIEM_TOKEN=""

# คำสั่งสำหรับ export log จาก SIEM (ต้องส่งออกข้อมูลผ่าน stdout)
# ตัวอย่าง (Splunk CLI): '/opt/splunk/bin/splunk search "search index=main earliest=-1d@d latest=@d" -maxout 0 -output csv -auth ${SIEM_USERNAME}:${SIEM_PASSWORD}'
# ตัวอย่าง (Elastic): 'curl -s -u ${SIEM_USERNAME}:${SIEM_PASSWORD} -H "Content-Type: application/json" -X POST "https://ES_HOST:9200/myindex/_search?size=1000" -d @/etc/siem-archiver/query.json | jq -r ".hits.hits[]._source"'
SIEM_EXPORT_CMD=""

# รูปแบบเอาต์พุต: csv หรือ json
EXPORT_FORMAT="csv"

# โฟลเดอร์ทำงานชั่วคราว
WORKDIR="/var/lib/siem-archiver"

# โฟลเดอร์ปลายทางบนเครื่อง (ต้องตรงกับ mount point ถ้าใช้ mount)
MOUNT_POINT="/mnt/gdrive"
REMOTE_SUBDIR="siem-archive"

# ตั้งค่าอัปโหลด: mount หรือ rclone_copy
UPLOAD_MODE="mount"    # หรือ "rclone_copy"
RCLONE_REMOTE="gdrive" # ชื่อ remote ใน rclone

# การบีบอัดและเข้ารหัส
COMPRESS="gzip"        # "none" หรือ "gzip"
ENCRYPT="none"         # "none" หรือ "gpg"
GPG_RECIPIENT=""       # อีเมลหรือ key id

# นโยบาย retention (ลบไฟล์ที่เก่ากว่าวันที่กำหนด)
RETENTION_DAYS=365

# ตั้งเวลาใน systemd timer (รูปแบบ systemd OnCalendar)
# ค่าเริ่มต้น ทุกวัน 01:10
BACKUP_SCHEDULE="*-*-* 01:10:00"

# ตั้งชื่อโครงสร้างไฟล์
FILENAME_PREFIX="siem-log"
